<form class="{{cssClass}}" autocomplete="off">
  <header class="sheet-header flexrow">
    <img class="profile-img" src="{{actor.img}}" data-edit="img" title="{{actor.name}}" />
    <div class="header-fields">
      <h1 class="actor-name">
        <input name="name" type="text" value="{{actor.name}}" placeholder="{{localize 'Name'}}" />
      </h1>
      <div class="details-grid">
        <label>
          <span>{{localize 'BNW.Detail.Concept'}}</span>
          <input type="text" name="system.details.concept" value="{{system.details.concept}}" />
        </label>
        <label>
          <span>{{localize 'BNW.Detail.Demeanor'}}</span>
          <input type="text" name="system.details.demeanor" value="{{system.details.demeanor}}" />
        </label>
        <label>
          <span>{{localize 'BNW.Detail.Quote'}}</span>
          <input type="text" name="system.details.quote" value="{{system.details.quote}}" />
        </label>
        <label>
          <span>{{localize 'BNW.Detail.Background'}}</span>
          <input type="text" name="system.details.background" value="{{system.details.background}}" />
        </label>
      </div>
    </div>
  </header>

  <nav class="sheet-tabs tabs" data-group="primary">
    <a class="item" data-tab="traits">{{localize 'BNW.Tab.TraitsSkills'}}</a>
    <a class="item" data-tab="powers">{{localize 'BNW.Tab.Powers'}}</a>
    <a class="item" data-tab="notes">{{localize 'BNW.Tab.Notes'}}</a>
  </nav>

  <section class="sheet-body">
    <div class="tab traits" data-group="primary" data-tab="traits">
      <div class="traits-grid">
        {{#each traits as |trait|}}
          <section class="trait-card" data-trait="{{trait.key}}">
            <header class="trait-header">
              <input class="trait-label" type="text" name="system.traits.{{trait.key}}.label" value="{{trait.label}}" />
              <div class="trait-value">
                <span>{{localize 'BNW.Label.TraitDice'}}</span>
                <input type="number" name="system.traits.{{trait.key}}.value" value="{{trait.value}}" min="0" />
              </div>
            </header>
            <table class="trait-skills">
              <thead>
                <tr>
                  <th>{{localize 'BNW.Label.Skill'}}</th>
                  <th>{{localize 'BNW.Label.Dice'}}</th>
                  <th>{{localize 'BNW.Label.Pool'}}</th>
                  <th class="roll-header">&nbsp;</th>
                </tr>
              </thead>
              <tbody>
                {{#if (hasEntries (lookup ../skillsByTrait trait.key))}}
                  {{#each (lookup ../skillsByTrait trait.key) as |skill|}}
                    <tr data-skill="{{skill.key}}">
                      <td class="skill-label">
                        <input type="text" name="system.skills.{{skill.key}}.label" value="{{skill.label}}" />
                      </td>
                      <td class="skill-dice">
                        <input type="number" name="system.skills.{{skill.key}}.value" value="{{skill.value}}" min="0" />
                      </td>
                      <td class="skill-pool">{{skill.pool}}</td>
                      <td class="skill-controls">
                        <button type="button" class="skill-roll" data-trait="{{trait.key}}" data-skill="{{skill.key}}">
                          <i class="fas fa-dice-six"></i>
                        </button>
                      </td>
                    </tr>
                  {{/each}}
                {{else}}
                  <tr>
                    <td colspan="4" class="empty">{{localize 'BNW.Label.NoSkills'}}</td>
                  </tr>
                {{/if}}
              </tbody>
            </table>
          </section>
        {{/each}}
      </div>
    </div>

    <div class="tab powers" data-group="primary" data-tab="powers">
      <div class="item-controls header">
        <button type="button" class="item-control item-create" data-type="power">
          <i class="fas fa-plus"></i> {{localize 'BNW.Action.AddPower'}}
        </button>
      </div>
      <ol class="powers-list">
        {{#each powers as |item|}}
          <li class="item power flexrow" data-item-id="{{item.id}}">
            <div class="item-name">
              <h4>{{item.name}}</h4>
              <p class="summary">{{item.system.summary}}</p>
            </div>
            <div class="item-info">
              <span class="dice">{{localize 'BNW.Label.BonusDice'}}: {{item.system.dice}}</span>
              <span class="pair">{{item.system.trait}} / {{item.system.skill}}</span>
            </div>
            <div class="item-controls">
              <a class="item-control power-roll" data-item-id="{{item.id}}" title="{{localize 'BNW.Action.RollPower'}}">
                <i class="fas fa-dice"></i>
              </a>
              <a class="item-control item-edit" data-item-id="{{item.id}}" title="{{localize 'BNW.Action.Edit'}}">
                <i class="fas fa-edit"></i>
              </a>
              <a class="item-control item-delete" data-item-id="{{item.id}}" title="{{localize 'BNW.Action.Delete'}}">
                <i class="fas fa-trash"></i>
              </a>
            </div>
          </li>
        {{/each}}
      </ol>
    </div>

    <div class="tab notes" data-group="primary" data-tab="notes">
      <div class="form-group stacked">
        <label>{{localize 'BNW.Label.Notes'}}</label>
        <textarea name="system.notes" placeholder="{{localize 'BNW.Placeholder.Notes'}}">{{system.notes}}</textarea>
      </div>
    </div>
  </section>
</form>
